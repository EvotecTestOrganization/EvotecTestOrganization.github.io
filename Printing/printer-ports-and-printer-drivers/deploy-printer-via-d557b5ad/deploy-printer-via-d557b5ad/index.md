# Deploy Printer via PowerShell for Microsoft Intun

## Original Links

- [x] Original Technet URL [Deploy Printer via PowerShell for Microsoft Intun](https://gallery.technet.microsoft.com/Deploy-Printer-via-d557b5ad)
- [x] Original Technet Description URL [Description](https://gallery.technet.microsoft.com/Deploy-Printer-via-d557b5ad/description)
- [x] Download: [Download Link](Download\Deploy-Printer.ps1)

## Output from Technet Gallery

#########################

#Â Â Â  PowerShell HelpÂ Â Â  #

#########################

&lt;#

.SYNOPSIS

This script is designed to deploy printers to Windows 10 workstations deployed and triggered by Intune.

.DESCRIPTION

Written by Jean-Pierre Simonis, Delivery Quality Assurance

https://www.linkedin.com/in/jsimonis/

Version 1.1

#########################

#Â Â Â Â Â  Change LogÂ Â Â Â Â Â  #

#########################

# 23/11/2017 1.1

# Features

# - Add support for MSI install keys so that script deployment via Intune reports as successful

#

# 10/11/2017 v1.0 - Initial Release

#Â  Features

# - Error trapping and logging

# - Unzip Printer Driver package

# - Install Local Printer Queue

.NOTES

#########################

#Â Â Â Â Â Â Â Â  NotesÂ Â Â Â Â Â Â Â  #

#########################

# This script is designed to be packaged as an exe and pushed out via Intune

#

#

# This script requires the following permissions

#

#Â  - Elevated PowerShell Session first time only to create custom eventlog type

#Â  - Permission to update install the printer (Assumed it will run in Intune installation context)

#Â  - Your endpoint protection may need this package to be added as an exception as it might detect and block it as this script extracts itself and launch a script in an administrative context

# Installation

# 1. Ensure script is run against Windows 10 devices with at least PowerShell V5.1

# 2. Create printer driver zip file

# 3. Configure variables in PowerShell Script to desired printer configuration supply name of driver zip file

# 4. Create batch file to launch PowerShell script (Refer below instructions for contents of batch file)

# 5. Create Self-extracting executable (I used WinRAR)

#Â Â Â Â Â Â  a.Â Â Â Â Â Â  Configure it to extract to temporary directory

#Â Â Â Â Â Â  b.Â Â Â Â Â Â  Configure post launch a command (deploy.bat)

#Â Â Â Â Â Â  c.Â Â Â Â Â Â  Configure Icon, Overwrite (Replace) and Title settings

#Â Â Â Â Â Â  d.Â Â Â Â Â Â  Configure for silent extraction (hidden dialogs)

#Â Â Â Â Â Â  e.Â  Â  Â  Â Ensure deploy.bat, Deploy-Printer.ps1, PrinterDriver.zip are added to archive

# 6. Use MSI Wrapper to convert the EXE to MSI

#Â Â Â Â Â Â  a. download from http://www.exemsi.com

#Â Â Â Â Â Â  b. Configure MSI Settings

#Â  Â  Â  Â  Â  Â  Â  Application ID (ensure this value is the same as defined in script configuration)

#Â  Â  Â  Â  Â  Â  Â  Deploy Printer Package 1

#Â  Â  Â  Â  Â  Â  Â  Upgrade Code (This can generated by MSI Wrapper)

#Â  Â  Â  Â  Â  Â  Â  {E6454CC0-00B2-4134-9D28-9089E5628C4B}

#Â  Â  Â  Â  Â  Â  Â  Product Name

#Â  Â  Â  Â  Â  Â  Â  Deploy Printer Package

#Â Â Â Â Â Â Â Â Â Â Â Â Â  Version

#Â Â Â Â Â Â Â Â Â Â Â Â Â  1.0.0.0

#Â Â Â Â Â Â Â Â Â Â Â Â Â  Icon

#Â Â Â Â Â Â Â Â Â Â Â Â Â  PowerShell.ico (I downloaded and used a powershell logo in ico format)

#Â Â Â Â Â Â Â Â Â Â Â Â Â  Comments

#Â Â Â Â Â Â Â Â Â Â Â Â Â  PowerShell Script to Deploy Campus Side Printer

#

# 7. (Optional) Use ORCA to modify MSI tables to update product name to remove (wrapped by MSI Wrapper in title or buy the product)

#Â Â Â Â Â Â Â  a. download from https://msdn.microsoft.com/en-us/library/windows/desktop/aa370557(v=vs.85).aspx

# 8. Configure Intune to deploy LOB Windows Application

# 9. Enjoy Customer SuccessðŸ˜Š

# Contents of deploy.bat

@echo off

REM Written by Jean-Pierre Simonis, Delivery Quality Assurance, www.deliveryqa.com.au

@echo Launching Printer Deployment PowerShell Script

powershell.exe -executionpolicy unrestricted -file .\Deploy-Printer.ps1

# End of Script

.LINK

http://www.deliveryqa.com.au

#&gt;

