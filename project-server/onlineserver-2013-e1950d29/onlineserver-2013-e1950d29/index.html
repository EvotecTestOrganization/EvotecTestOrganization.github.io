<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki - LoveIt</title><meta name="Description" content="About LoveIt Theme"><meta property="og:title" content="Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki" />
<meta property="og:description" content="Original Links  Original Technet URL Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki Original Technet Description URL Description Download: [Download Link](Download\Neos-SDI Project Online Starter Kit.zip)  Output from Technet Gallery This project illustrates how to use Project Server 2013 CSOM for:
  Reading Project and Tasks
  Adding Tasks, and Timephased Assignment
  Adding Timephased Actual on Assignment
   It&rsquo;s a simple console application, and work on Project Online, as well as Project On Prem." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" />
<meta property="og:image" content="/logo.png"/>
<meta property="article:published_time" content="2019-12-01T21:57:40+08:00" />
<meta property="article:modified_time" content="2020-01-01T16:45:40+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/logo.png"/>

<meta name="twitter:title" content="Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki"/>
<meta name="twitter:description" content="Original Links  Original Technet URL Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki Original Technet Description URL Description Download: [Download Link](Download\Neos-SDI Project Online Starter Kit.zip)  Output from Technet Gallery This project illustrates how to use Project Server 2013 CSOM for:
  Reading Project and Tasks
  Adding Tasks, and Timephased Assignment
  Adding Timephased Actual on Assignment
   It&rsquo;s a simple console application, and work on Project Online, as well as Project On Prem."/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" /><link rel="prev" href="/project-server/power-bi-report-pack-4506f183/power-bi-report-pack-4506f183/" /><link rel="next" href="/project-server/online-work-and-capacity-30a67204/online-work-and-capacity-30a67204/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "\/project-server\/onlineserver-2013-e1950d29\/onlineserver-2013-e1950d29\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "Project Server","keywords": "Active Directory, HTML","wordcount":  1714 ,
        "url": "\/project-server\/onlineserver-2013-e1950d29\/onlineserver-2013-e1950d29\/","datePublished": "2019-12-01T21:57:40+08:00","dateModified": "2020-01-01T16:45:40+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "\/images\/avatar.png",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "Sylvain Gross ALM-EPM Practice Manager - Neos-SDI"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="LoveIt"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>LoveIt</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/archive/"> Archive </a><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/printing/"> Printing </a><a class="menu-item" href="/project-server/"> Project Server </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/categories/documentation/"> Docs </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="LoveIt"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>LoveIt</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/archive/" title="">Archive</a><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/printing/" title="">Printing</a><a class="menu-item" href="/project-server/" title="">Project Server</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/categories/documentation/" title="">Docs</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Sylvain Gross ALM-EPM Practice Manager - Neos-SDI</a></span>&nbsp;<span class="post-category">included in <a href="/categories/project-server/"><i class="far fa-folder fa-fw"></i>Project Server</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2019-12-01">2019-12-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1714 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;9 minutes&nbsp;<span id="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" class="leancloud_visitors" data-flag-title="Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#original-links">Original Links</a></li>
    <li><a href="#output-from-technet-gallery">Output from Technet Gallery</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="original-links">Original Links</h2>
<ul>
<li><i class="far fa-check-square fa-fw"></i> Original Technet URL <a href="https://gallery.technet.microsoft.com/OnlineServer-2013-e1950d29" target="_blank" rel="noopener noreffer">Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki</a></li>
<li><i class="far fa-check-square fa-fw"></i> Original Technet Description URL <a href="https://gallery.technet.microsoft.com/OnlineServer-2013-e1950d29/description" target="_blank" rel="noopener noreffer">Description</a></li>
<li><i class="far fa-check-square fa-fw"></i> Download: [Download Link](Download\Neos-SDI Project Online Starter Kit.zip)</li>
</ul>
<h2 id="output-from-technet-gallery">Output from Technet Gallery</h2>
<p>This project illustrates how to use Project Server 2013 CSOM for:</p>
<ul>
<li>
<p>Reading Project and Tasks</p>
</li>
<li>
<p>Adding Tasks, and Timephased Assignment</p>
</li>
<li>
<p>Adding Timephased Actual on Assignment</p>
</li>
</ul>
<p> <img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="Images%5ccapture-timesheet.png"
        data-srcset="Images%5ccapture-timesheet.png, Images%5ccapture-timesheet.png 1.5x, Images%5ccapture-timesheet.png 2x"
        data-sizes="auto"
        alt="Images\capture-timesheet.png"
        title="Images\capture-timesheet.png" /></p>
<p>It&rsquo;s a simple console application, and work on Project Online, as well as Project On Prem. All methods are commented, specially where things seems not obvious.</p>
<p> <img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="Images%5ccapture-console.png"
        data-srcset="Images%5ccapture-console.png, Images%5ccapture-console.png 1.5x, Images%5ccapture-console.png 2x"
        data-sizes="auto"
        alt="Images\capture-console.png"
        title="Images\capture-console.png" /></p>
<p>This project is intented to be a helper for your development, because the Project Server 2013 SDK is not fully documented. On the Support Forum in Technet, a lot of questions are often asked, related to this area of development. So I hope that this project will save (a bit of) your time.</p>
<p>The pre requisite are:</p>
<ul>
<li>
<p>Having a Project Server 2013 instance on line or On Premise</p>
</li>
<li>
<p>Having at list One project</p>
</li>
<li>
<p>The periods must be created, and the Timesheet for the current period must be created (simply click on the TimeSheet link on PWA). This issue will be solved soon.</p>
</li>
<li>
<p>The current user must be defined as a resource</p>
</li>
<li>
<p>On your development machine, VS2013, Project Server 2013 SDK, and the SharePoint Server 2013 Client Components SDK.</p>
</li>
</ul>
<p>Normally, all dependencies are included in the Libraries folder.</p>
<p>Some of these assemblies must be in GAC If you need more info, contact me:</p>
<p>mail: mailto://sylvain.gross@neos-sdi.com</p>
<p>twitter: @SylvainGrossNeo</p>
<p>If you have some suggestions, or improvement proposal, don&rsquo;t hesitate to contact me. This app may contain some bugs or &ldquo;undiscovered behaviour&rdquo; ;-), it&rsquo;s not intended to be used as is in Production.</p>
<p>Your feedback are welcome to improve this code. You can also contact me if you have difficulties to create a Project Online tenant, or Project Server environment.</p>
<p>C#</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Microsoft.ProjectServer.Client;
using Microsoft.SharePoint.Client;
//using NeosSDI.ProjectOnline.Business;
namespace NeosSDI.ProjectOnline.CSOM
{
    public class ProjectCSOMManager
    {
        // Change this value if you are on prem and not Online
        private static  bool IsProjectOnline = true;
        private static int timeOut = 20;
        private static string projName = &#34;yourtenant&#34;; // define the name of your tenant here
        private static string connectUserName = &#34;administrator&#34;; // user name with the domaine
        private static string connectPwd = &#34;YOUR PWD&#34;; // your pwd
        private static string projDomain = string.Format(&#34;{0}.onmicrosoft.com&#34;, projName);
        // Set the Project Server client context.
        private static ProjectContext projContext;
        private static string PwaPath
        {
            get
            {
                // Change here the name of the PWA instance: PWA should be the must common case.
                if (IsProjectOnline)
                    return string.Format(&#34;https://{0}.sharepoint.com/sites/pwa&#34;, projName);
                else
                    return &#34;http://2013-sp/pwa&#34;;
            }
        }
        /// &lt;summary&gt;
        /// This method performs a very simple operation: Read Projects, and the Tasks of these projets
        /// Result is stored in the ProjectContext, and returned to the client.
        /// Step by step, we have to:
        /// - Manage authentification, for Project Online, or Project On Prem
        /// - Create the Query, to ask for the projects, and to include some additionnal properties (dates, tasks...)
        /// - Execute the Query
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static ProjectContext ReadProjects()
        {
            try
            {
                projContext = new ProjectContext(PwaPath);
                if (IsProjectOnline)
                    projContext.ExecutingWebRequest += ClaimsHelper.clientContext_ExecutingWebRequest;
                else
                    projContext.Credentials = new System.Net.NetworkCredential(&#34;alexd&#34;, &#34;pass@word1&#34;, &#34;contoso&#34;);
                // Use IncludeWithDefaultProperties to force CSOM to load the Tasks collection, otherwize we have a (very) lazy loading
                // Careful: the Load method does not perform the Load ! It prepare the context before the ExecuteQuery is run.
                projContext.Load(projContext.Projects,
                    c =&gt; c.IncludeWithDefaultProperties(pr =&gt; pr.StartDate, pr =&gt; pr.FinishDate, pr =&gt; pr.Tasks));
                // Actual execution of the Load - AFter this method, the Projects collection contains data, and the properties which are specified below.
                projContext.ExecuteQuery();
            }
            catch (Exception ex)
            {
                throw ex;
            }
            return projContext;
        }
        /// &lt;summary&gt;
        /// This method add a task to the project, and assign, me to it.
        /// The date of assignment is hardcoded to today
        ///
        /// The steps:
        /// - Manage authentification, for Project Online, or Project On Prem
        /// - Prepare the Queries to load Projects and the Web Context (to get the current user)
        /// - Execute this first queries
        /// - Prepare the Query to load the Resource linked to the current user
        /// - Load the First existing Project, and check it out, to get its Draft version
        /// - Create the Task with the TaskCreationInformation class
        /// - Add it to the Project
        /// - Update the Project, and execute this long query
        /// - Create an assignment for this task, and the current resource, with the AssignmentCreationInformation class
        /// - Add it to the Project
        /// - Update the Project, and execute this query
        /// - Publish/Checkin the project
        /// &lt;/summary&gt;
        public static void AddTasksToProject()
        {
            try
            {
                projContext = new ProjectContext(PwaPath);
                if (IsProjectOnline)
                    projContext.ExecutingWebRequest += ClaimsHelper.clientContext_ExecutingWebRequest;
                else
                    projContext.Credentials = new System.Net.NetworkCredential(&#34;alexd&#34;, &#34;pass@word1&#34;, &#34;contoso&#34;);
                // Use IncludeWithDefaultProperties to force CSOM to load the Tasks collection, otherwize we have a lazy loading
                // Careful: the Load method does not perform the Load ! It prepare the context before the ExecuteQuery is run.
                projContext.Load(projContext.Projects,
                    c =&gt; c.IncludeWithDefaultProperties(pr =&gt; pr.StartDate, pr =&gt; pr.FinishDate, pr =&gt; pr.Tasks));
                projContext.Load(projContext.Web.CurrentUser);
                projContext.ExecuteQuery();
                string currentUserName = projContext.Web.CurrentUser.LoginName;
                // Important to exclude resource without associated user (a resource who does not have an account)
                projContext.Load(projContext.EnterpriseResources,
                        res =&gt; res.IncludeWithDefaultProperties(r =&gt; r.User, r =&gt; r.User.LoginName).Where(r =&gt; r.User != null &amp;&amp; r.User.LoginName == currentUserName));
                // Actual execution of the Load - After this method, the Projects collection contains data, and the properties which are specified below.
                projContext.ExecuteQuery();
                var pubProject = projContext.Projects.FirstOrDefault();
                var currentProject = pubProject.CheckOut();
                if (currentProject == null)
                    throw new Exception(&#34;Please create a project !&#34;);
                var currentResource = projContext.EnterpriseResources.FirstOrDefault();
                if (currentResource == null)
                    throw new Exception(&#34;Please create yourself as a resource !&#34;);
                TaskCreationInformation tsk = new TaskCreationInformation();
                tsk.Name = string.Format(&#34;Task created at {0}&#34;, DateTime.Now);
                tsk.Start = DateTime.Now;
                tsk.Finish = DateTime.Now.AddDays(3);
                var newTask = currentProject.Tasks.Add(tsk);
                projContext.Load(newTask);
                QueueJob qj = currentProject.Update();
                JobState js = projContext.WaitForQueue(qj, timeOut);
                projContext.ExecuteQuery();
                AssignmentCreationInformation ass = new AssignmentCreationInformation();
                ass.ResourceId = currentResource.Id;
                ass.TaskId = newTask.Id;
                ass.Start = newTask.Start;
                ass.Finish = newTask.Finish;
                currentProject.Assignments.Add(ass);
                currentProject.Update();
                qj= currentProject.Publish(true);
                js = projContext.WaitForQueue(qj, timeOut);
                projContext.ExecuteQuery();
            }
            catch (Exception ex)
            {
                System.Diagnostics.Trace.WriteLine(ex.Message);
                throw ex;
            }
        }
        /// &lt;summary&gt;
        /// This method add actuals to an existing assignment, by using TimeSheets.
        /// Pre requisite: periods must be created
        /// Current bug: the timehseet must exist for this period (simply clic on TimeSheet link in PWA once for the current period
        /// Steps are:
        /// - Manage authentification, for Project Online, or Project On Prem
        /// - Prepare the Query to load the Web Context (to get the current user)
        /// - Execute this first query
        /// - Prepare the Query to load the Resource linked to the current user
        /// - Prepare the Query to load the current period, by including, TimeSheet, which includes Lines, which include Work and Assignments. The lines are filtered in order to include only Standard Lines, and not admin lines (sick, vacation...)
        /// - Execute this Query
        /// - For the current line, retrieve the planned work for today
        /// - Create the TimesheetWork with the TimeSheetWorkCreationInformation class, and set the different properties
        /// - Add this work to the line, and Update the TimeSheet
        /// - Submit the TimeSheet, after management of the current status of the TimeSheet
        /// &lt;/summary&gt;
        public static void AddActualToTaskTimeSheet()
        {
            try
            {
                projContext = new ProjectContext(PwaPath);
                if (IsProjectOnline)
                    projContext.ExecutingWebRequest += ClaimsHelper.clientContext_ExecutingWebRequest;
                else
                    projContext.Credentials = new System.Net.NetworkCredential(&#34;alexd&#34;, &#34;pass@word1&#34;, &#34;contoso&#34;);
                projContext.Load(projContext.Web.CurrentUser);
                projContext.ExecuteQuery();
                string currentUserName = projContext.Web.CurrentUser.LoginName;
                // Important to exclude resource without associated user (a resource who does not have an account)
                projContext.Load(projContext.EnterpriseResources,
                        res =&gt; res.IncludeWithDefaultProperties(r =&gt; r.User, r =&gt; r.User.LoginName).Where(r =&gt; r.User != null &amp;&amp; r.User.LoginName == currentUserName));
                // Actual execution of the Load - After this method, the Projects collection contains data, and the properties which are specified below.
                projContext.ExecuteQuery();
                var currentResource = projContext.EnterpriseResources.FirstOrDefault();
                if (currentResource == null)
                    throw new Exception(&#34;Please create yourself as a resource !&#34;);
                projContext.Load(projContext.TimeSheetPeriods, c =&gt; c.Where(p =&gt; p.Start &lt;= DateTime.Now &amp;&amp; p.End &gt;= DateTime.Now).
                    IncludeWithDefaultProperties(p =&gt; p.TimeSheet,
                                                 p =&gt; p.TimeSheet.Lines.Where(l =&gt; l.LineClass== TimeSheetLineClass.StandardLine).
                    IncludeWithDefaultProperties(l =&gt; l.Assignment,
                                                       l =&gt; l.Assignment.Task,
                                                       l =&gt; l.Work)));
                projContext.ExecuteQuery();
                var myPeriod = projContext.TimeSheetPeriods.FirstOrDefault();
                if (myPeriod == null)
                    throw new Exception(&#34;Please create the periods in your server settings&#34;);
                var line = myPeriod.TimeSheet.Lines.Last();// FirstOrDefault();
                var plannedwork = line.Work.Where(w =&gt; w.Start.Date == DateTime.Now.Date).FirstOrDefault();
                TimeSheetWorkCreationInformation workCreation = new TimeSheetWorkCreationInformation
                {
                    ActualWork = string.Format(&#34;{0}h&#34;, 6),
                    Start = DateTime.Now,
                    End = DateTime.Now,
                    Comment = &#34;From CSOM&#34;,
                    NonBillableOvertimeWork = &#34;0&#34;,
                    NonBillableWork = &#34;0&#34;,
                    OvertimeWork = &#34;0&#34;,
                    PlannedWork = plannedwork == null ? &#34;0h&#34; : plannedwork.PlannedWork
                };
                line.Work.Add(workCreation);
                myPeriod.TimeSheet.Update();
                if (myPeriod.TimeSheet.Status == TimeSheetStatus.Approved ||
                    myPeriod.TimeSheet.Status == TimeSheetStatus.Submitted ||
                    myPeriod.TimeSheet.Status == TimeSheetStatus.Rejected)
                {
                    myPeriod.TimeSheet.Recall();
                }
                myPeriod.TimeSheet.Submit(&#34;GO&#34;);
                projContext.ExecuteQuery();
            }
            catch (Exception ex)
            {
                System.Diagnostics.Trace.WriteLine(ex.Message);
                throw ex;
            }
        }
        #region Helper Methods
        /// &lt;summary&gt;
        /// This properties manages Authentification for Project Online, through the well known Helper.Office365.Claims assembly
        /// &lt;/summary&gt;
        private static Helper.Office365.MsOnlineClaimsHelper ClaimsHelper
        {
            get
            {
                return new Helper.Office365.MsOnlineClaimsHelper(new Uri(PwaPath),
                                                    string.Format(&#34;{0}@{1}&#34;, connectUserName, projDomain),
                                                    connectPwd);
            }
        }
        private static string GetFullUserName(string userName)
        {
            return string.Format(&#34;i:0#.f|membership|{0}@{1}&#34;, userName, projDomain);
        }
        #endregion
    }
}
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-01-01</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" data-title="Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki" data-via="xxxx" data-hashtags="Active Directory,HTML"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" data-hashtag="Active Directory"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" data-title="Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" data-title="Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="/project-server/onlineserver-2013-e1950d29/onlineserver-2013-e1950d29/" data-title="Project Online/Server 2013: Timephased Work Management with CSOM - Starter Ki"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/active-directory/">Active Directory</a>,&nbsp;<a href="/tags/html/">HTML</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/project-server/power-bi-report-pack-4506f183/power-bi-report-pack-4506f183/" class="prev" rel="prev" title="Project Power BI Report Pack"><i class="fas fa-angle-left fa-fw"></i>Project Power BI Report Pack</a>
            <a href="/project-server/online-work-and-capacity-30a67204/online-work-and-capacity-30a67204/" class="next" rel="next" title="Project Online Work and Capacity Graphs">Project Online Work and Capacity Graphs<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{"valine":{"appId":"QGzwQXOqs5JOhN4RGPOkR2mR-MdYXbMMI","appKey":"WBmoGyJtbqUswvfLh6L8iEBr","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"serverURLs":"https://leancloud.hugoloveit.com","visitor":true}},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
